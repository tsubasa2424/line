<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>仮想通貨価格監視</title>
    <style>
        .currency-button {
            padding: 10px;
            margin: 5px;
            border: 2px solid #ccc;
            background-color: white;
            cursor: pointer;
            font-size: 16px;
        }
        .currency-button.selected {
            background-color: #4CAF50;
            color: white;
            border-color: #4CAF50;
        }
    </style>
    <script>
        let selectedCurrency = null;

        function selectCurrency(symbol) {
            selectedCurrency = symbol;
            document.querySelectorAll(".currency-button").forEach(btn => btn.classList.remove("selected"));
            document.getElementById(symbol).classList.add("selected");
        }

        async function addCurrency() {
            if (!selectedCurrency) {
                alert("通貨を選択してください");
                return;
            }
            const price = document.getElementById("price").value;
            const condition = document.getElementById("condition").value;

            if (!price) {
                alert("価格を入力してください");
                return;
            }

            const response = await fetch("/add", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ symbol: selectedCurrency, price, condition }),
            });

            const data = await response.json();
            alert(data.message);
            loadWatchlist();
        }

        async function loadWatchlist() {
            const response = await fetch("/watchlist");
            const watchlist = await response.json();
            const table = document.getElementById("watchlist-table");
            table.innerHTML = "<tr><th>通貨</th><th>価格</th><th>条件</th></tr>";

            watchlist.forEach(item => {
                table.innerHTML += `<tr>
                    <td>${item.symbol}</td>
                    <td>${item.price}</td>
                    <td>${item.condition}</td>
                </tr>`;
            });
        }

        window.onload = loadWatchlist;
    </script>
</head>
<body>
    <h1>仮想通貨価格監視</h1>

    <h3>通貨を選択:</h3>
    <button id="btc_jpy" class="currency-button" onclick="selectCurrency('btc_jpy')">ビットコイン (BTC)</button>
    <button id="eth_jpy" class="currency-button" onclick="selectCurrency('eth_jpy')">イーサリアム (ETH)</button>
    <button id="xrp_jpy" class="currency-button" onclick="selectCurrency('xrp_jpy')">リップル (XRP)</button>
    <button id="ltc_jpy" class="currency-button" onclick="selectCurrency('ltc_jpy')">ライトコイン (LTC)</button>
    <button id="xlm_jpy" class="currency-button" onclick="selectCurrency('xlm_jpy')">ステラルーメン (XLM)</button>
    <button id="flr_jpy" class="currency-button" onclick="selectCurrency('flr_jpy')">フレア (FLR)</button>

    <br><br>

    <label>価格:</label>
    <input type="number" id="price" placeholder="価格を入力">

    <label>条件:</label>
    <select id="condition">
        <option value="以上">以上</option>
        <option value="以下">以下</option>
    </select>

    <button onclick="addCurrency()">追加</button>

    <h2>監視リスト</h2>
    <table id="watchlist-table">
        <tr><th>通貨</th><th>価格</th><th>条件</th></tr>
    </table>
</body>
</html>
